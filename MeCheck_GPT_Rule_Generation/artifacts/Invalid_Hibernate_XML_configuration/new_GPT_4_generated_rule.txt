Rule invalid-hibernate-xml-configuration {
  for (file xml in getXMLs()) {
    if (elementExists(xml, "<class>")) {
      for (<class> class in getElms(xml, "<class>")) {
        String className = getAttr(class, "name");
        if (NOT isEmpty(className)) {
          assert ( classExists(className) AND NOT isLibraryClass(className) ) {
            msg("Class: %s is either non-instantiable or does not extend the required class or has inappropriate scope", className);
          }
        }
        if (isEmpty(getAttr(class, "scope"))) {
          msg("Class: %s has an empty scope attribute", className);
        }
        if (NOT elementExists(class, "<property>")) {
          msg("Class: %s does not include the required children tags or attributes", className);
        }
        if (NOT isUniqueSN(className)) {
          msg("Class: %s is defined with a duplicate name", className);
        }
      }
    }
  }
}
